-- Lets start with running some simple queries
   -- 1) Extracting the information for 'Liverpool' from team table
   
        SELECT * from team
        WHERE team_long_name= 'Liverpool';
        
   -- 2)Counting total number of matches Liverpool played
   
   select count(*) from matches
   where home_team_api_id= 8650 or away_team_api_id = 8650;
   
   -- 3)Checking all the available seasons
   
   select distinct(season) from matches;
   
   -- 4)Matches Won by liverpool every season
   
   SELECT season,count(*) as total_matches_won_byLiverpool from matches
   where (away_team_api_id= 8650 or away_team_goal>home_team_goal)
   and   (home_team_api_id= 8650 or away_team_goal<home_team_goal)
   group by season;
   
  -- 5)Identify the total matches of home team as Chelsea,Liverpool or neither
   
    select 
     case 
        when home_team_api_id in( select team_api_id from team where team_long_name='Liverpool')
	       then 'Liverpool'
        when home_team_api_id in(select team_api_id from team where team_long_name='Chelsea')
	       then 'Chelsea'  
     end as home_team_name,
    count(*) as total
    from matches
    group by home_team_name;
    
    
  -- 6)Query that identifies a match's winner,scoreline,date, identifies the identity of the opponent, and finally filters for Liverpool as the home team for 2015/2016 season
  
  
  SELECT date,team_long_name as Opponent,concat(m.home_team_goal,'-',m.away_team_goal) as Scoreline,
     CASE WHEN m.home_team_goal>m.away_team_goal THEN 'Liverpool win'
          WHEN m.home_team_goal<m.away_team_goal THEN 'Liverpool loss'
          ELSE 'Tie' END AS Result
  from matches as m
   inner join team as t
   on m.away_team_api_id = t.team_api_id
   where m.home_team_api_id in(
       select team_api_id 
       from team where team_short_name='LIV') 
       and 
   season='2015/2016';
   
   
   -- 7)Query that identifies a match's winner,scoreline,date, identifies the identity of the opponent, and finally filters for Liverpool as the away team for 2015/2016 season
 
   
   SELECT date,team_long_name as Opponent,concat(m.home_team_goal,'-',m.away_team_goal) as Scoreline,
CASE WHEN m.home_team_goal<m.away_team_goal THEN 'Liverpool win'
     WHEN m.home_team_goal>m.away_team_goal THEN 'Liverpool loss'
     ELSE 'Tie' END AS Result
from matches as m
inner join team as t
on m.home_team_api_id = t.team_api_id
where m.away_team_api_id in(select team_api_id from team where team_short_name='LIV') and season='2015/2016';




-- 8)Retrieve information about matches played between Liverpool And Manchester United

SELECT 
	date,concat(home_team_goal,'-',away_team_goal)as result,
	-- Identify the home team as Liverpool or Manchester United
	case when home_team_api_id = 8650 then 'Liverpool' 
        else 'Manchester United' end as home,
    -- Identify the away team as Liverpool or Manchester United
	case when away_team_api_id = 10260 then 'Manchester United' 
        else 'Liverpool' end as away,
	case 
    when home_team_goal > away_team_goal and home_team_api_id = 8650 then 'Liverpool win!'
        WHEN home_team_goal > away_team_goal and home_team_api_id = 10260 then 'Manchester United win!'
        WHEN home_team_goal < away_team_goal and away_team_api_id = 8650 then 'Liverpool win!'
        WHEN home_team_goal < away_team_goal and away_team_api_id = 10260 then 'Manchester United win!'
        else 'Tie!' END as outcome
FROM matches
WHERE (away_team_api_id = 8650 OR home_team_api_id = 8650)
      AND (away_team_api_id = 10260 OR home_team_api_id = 10260);


    
   

